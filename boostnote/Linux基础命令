# Linux基础命令
### 用户管理
增加用户
>useradd rain

给新用户设置密码
>passwd rain
>非交互式设置密码(echo "123"|passwd --stdin rain && history -c)

切换用户
>su - rain
>su命令中间的-号很重要，意味着完全切换到新的用户，即环境变量信息也变更为新用户的信息

查看当前用户
>whoami

退出用户登录
>logout

删除用户
>userdel -r rain 
>-f    强制删除用户 
>-r    同时删除用户以及家目录

sudo命令的作用
>用来以其他身份来执行命令，预设的身份为root。在/etc/sudoers中设置了可执行sudo指令的用户。若其未经授权的用户企图使用sudo，则会发出警告的邮件给管理员。用户使用sudo时，必须先输入密码，之后有5分钟的有效期限，超过期限则必须重新输入密码。相当于大臣拿着圣旨去做事！

新用户想要使用root权限
>在/etc/sudoers中将该用户添加
>visudo -f /etc/sudoers
>然后找到root那一行，直接复制这一行的数据，然后将root修改为rain
>此时就可以sudo ls /root

### 文件与目录权限
Linux权限的目的是（保护账户的资料）
Linux权限主要依据三种身份来决定：
>user/owner 文件使用者,文件属于哪个用户
group 属组,文件属于哪个组
others 既不是user，也不再group，就是other，其他人

权限是什么
>在Linux中，每个文件都有所属的所有者，和所有组，并且规定了文件的所有者，所有组以及其他人对文件的，可读，可写，可执行等权限。
对于目录的权限来说，可读是读取目录文件列表，可写是表示在目录内新增，修改，删除文件。可执行表示可以进入目录

> \- 普通文件 
d  文件夹 
l   快捷方式，软连接   link 快捷方式

文件权限
>r    cat 
w     vim 
x    可执行 ，如同 .sh  .py 

目录权限
>r    可以对此目录执行ls列出所有文件
w    可以在这个目录创建文件 touch
x    可以cd进入这个目录，或者查看详细信息  

![ba3211a2.png](:storage/f2ec9ebe-96a1-4929-a481-a70bd73654ca/ba3211a2.png)

权限数字的转化
![db2a59c3.png](:storage/f2ec9ebe-96a1-4929-a481-a70bd73654ca/db2a59c3.png)

修改文件权限
>chmod (change mode 更改权限)
chmod   u/g/o  
user  
group 
other 
chmod  u+r  file 
chmod  u+w  file 
chmod  u+x   file 
chmod  g+r   file 
chmod  g+w   file 
chmod  g+x   file 
chmod  o+r   file 
chmod  o+w   file 
chmod  o+x   file 

>chmod  775  file 

修改文件属组
>chown  rain  file   更改file的属主是rain
chgrp  rain  file   更改file的属组是rain

软连接
ln -s  目标文件  快捷方式绝对路径
>直接输入python3，定位到/opt/python3/bin/python3.6  ，解决方案
1.添加path 
echo $PATH
[root@qishione tmp]# echo $PATH
/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin

>2.添加软连接 (不如path来的彻底，方便)
#这条命令，仅仅是添加了python3.6的解释器
ln -s  /opt/python3/bin/python3.6   /usr/local/bin/python3 
ln -s /opt/python3/bin/pip3   /usr/local/bin/pip3 
就会在/usr/local/bin/python3 

>当我们输入python3的时候
python3.6

xftp 公司会用这个上传下载文件夹
支持断点续传

linux的命令提示符
>echo $PS1

### PS1环境变量
echo $PS1
[\u@\h \W]\$
>可以自行调整全局变量/etc/profile文件用于永久生效 PS1='[\u@\h \W\t]\$'
\d　　日期
\H　　完整主机名
\h　　主机名第一个名字
\t　　时间24小时制HHMMSS
\T　　时间12小时制
\A　　时间24小时制HHMM
\u　　当前用户账号名
\v　　BASH的版本
\w　　完整工作目录
\W　　利用basename取得工作目录名
\#　　下达的第几个命令
\$　　提示字符，root为#，普通用户为$
PS1 > 变量名
$PS1 > 查看变量内容
PS1=新内容 重新赋值
PS1显示ip地址
export PS1="[\u@\h `/sbin/ifconfig ens33 | sed -nr 's/.*inet (addr:)?(([0-9]*\.){3}[0-9]*).*/\2/p'` \w]\$"

### tar压缩解压命令
用来压缩和解压文件。tar本身不具有压缩功能。他是调用压缩功能实现的
>tar   -zcvf     压缩文件 
tar   -zxvf      解压缩文件
-z  调用gzip命令
-x  解压缩文件
-v 显示解压/压缩过程
-f 指定一个文件 
-c  压缩文件 

>调用tar命令  -c压缩  -f指定文件名   压缩 ./*  当前目录的所有内容
tar -cf  alltmp.tar   ./*  
>解压缩文件
tar -xf  alltmp.tar 

压缩成gzip文件
>tar  -zcvf  alltmp.tar.gz    * 
>解压 
>tar -zxf  alltmp2.tar.gz 


### netstat命令
netstat命令用来打印Linux中网络系统的状态信息，可让你得知整个Linux系统的网络情况。
* netstat -tunlp
>netstat [选项]
-t或--tcp：显示TCP传输协议的连线状况；
-u或--udp：显示UDP传输协议的连线状况；
-n或--numeric：直接使用ip地址，而不通过域名服务器；
-l或--listening：显示监控中的服务器的Socket；
-p或--programs：显示正在使用Socket的程序识别码和程序名称；
-a或--all：显示所有连线中的Socket；

### ps命令
ps 命令用于查看系统中的进程状态，格式为“ps [参数]”。
* ps -aux
>ps　　命令常用参数
-a     显示所有进程
-u     用户以及其他详细信息
-x    显示没有控制终端的进程

### kill命令
kill命令用来删除执行中的程序或工作。kill可将指定的信息送至程序。
>kill  pid 
kill -9   pid 
	-9参数，发送一个强制终止信号
pkill  支持正则匹配的kill命令
pkill  vim   一次性杀死所有关vim的进程

### killall命令
通常来讲，复杂软件的服务程序会有多个进程协同为用户提供服务，如果逐个去结束这 些进程会比较麻烦，此时可以使用 killall 命令来批量结束某个服务程序带有的全部进程。
>例如nginx启动后有2个进程
killall nginx 

### SELinux功能
SELinux(Security-Enhanced Linux) 是美国国家安全局（NSA）对于强制访问控制的实现，这个功能管理员又爱又恨，大多数生产环境也是关闭的做法，安全手段使用其他方法。
+ 大多数ssh连接不上虚拟机，都是因为防火墙和selinux阻挡了

永久关闭selinx
>1.找到配置文件 
vim /etc/selinx/config 
SELINUX=disabled
2.重启服务器，永久生效

临时关闭selinux(命令行修改，重启失效)
>getenforce #获取selinux状态
>setenforce [ Enforcing | Permissive | 1 | 0 ]
>数字0 表示permissive，给出警告，不会阻止，等同disabled
数字1表示enforcing，表示开启

### iptables防火墙
在学习阶段，关闭防火墙可以更方便的学习，在企业环境中，一般只有配置外网ip的linux服务器才会开启防火墙，但是对于高并发流量的业务服务器仍然是不能开启的，会有很大性能损失，因此需要更nb的硬件防火墙。
>systemctl status firewalld #查看防火墙状态
systemctl stop firewalld    #关闭防火墙
systemctl disable firewalld#关闭防火墙开机启动
systemctl is-enabled firewalld.service#检查防火墙是否启动

### Linux中文显示设置（防止中文乱码）
此项优化为可选项，根据个人情况选择是否调整Linux系统的字符集，字符集就是一套文字符号以及编码。
>查看系统当前字符集
>echo $LANG
>1.修改配置文件/etc/locale.conf
LANG="zh_CN.UTF-8"
2.更改后查看系统语言变量
locale

### df命令
df -h
查看磁盘分区
>df(选项)(参数)
-h或--human-readable：以可读性较高的方式来显示信息；
-k或--kilobytes：指定区块大小为1024字节；
-T或--print-type：显示文件系统的类型；
--help：显示帮助；
--version：显示版本信息。

### 设置主机名
hostnamectl set-hostname summer
查看主机名
hostname

### DNS
域名解析系统
dns解析原理:
>1.当用户在浏览器输入 www.pythonav.cn的时候
2.第一步去本地dns缓存中查找域名记录，如果没有就去
3./etc/hosts文件中，查找是否有本地解析记录，如果没有
4.去/etc/resolv.conf 指定的dns服务器中查找记录，如果没有，就是公网根本没有注册这个域名

dns就是网络上一个 key-value的域名数据库 

linux的dns配置文件
>1./etc/hosts  优先级最高，本地dns记录解析 ，如果买不起域名，就用这个，做本地测试开发
2.cat /etc/resolv.conf 
	Generated by NetworkManager
	nameserver   119.29.29.29   #主dns记录
	nameserver   223.5.5.5   	#备dns记录

	114.114.114.114  114的dns服务器
	119.29.29.29    腾讯的dns服务器
	223.5.5.5    阿里巴巴的dns服务器
	223.6.6.6    阿里巴巴的dns服务器

### 计划任务crond服务
后台运行，到了预定的时间就会自动执行的任务，前提是：事先手动将计划任务设定好。这就用到了crond服务

查看计划任务的规则
>crontab -l

编辑定时任务
>crontab  -e

基本格式
>crontab任务配置基本格式：
\*  *　 *　 *　 *　　command
分钟(0-59)　小时(0-23)　日期(1-31)　月份(1-12)　星期(0-6,0代表星期天)　 命令
>第1列表示分钟1～59 每分钟用*或者 */1表示
第2列表示小时1～23（0表示0点）
第3列表示日期1～31
第4列表示月份1～12
第5列标识号星期0～6（0表示星期天）
第6列要运行的命令
星号（*）：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。
30 08 * * *  每天8.30去上班  
逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”
中杠（-）：可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”
正斜线（/）：可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。
*/3 * * * * /usr/sbin/ntpdate ntp1.aliyun.com  每隔三分钟执行下时间同步

### 自定义yum仓库
为什么要修改？
>yum默认配置的是centos的国外仓库地址，修改为阿里云的yum仓库，加速下载

配置阿里云yum源的步骤
>1.备份旧的yum源
	cd /etc/yum.repos.d/
	mkdir allbak
	mv *  allbak 
2.下载新的阿里云yum源
	wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
		-O  指定下载后的文件，存放到某个路径，切改名
	配置第三方软件源，epel源
		wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
	3.清空旧的yum缓存
		yum clean all 
	4.生成新的阿里云的yum缓存
	 yum makecache 
	5.安装一个软件，测试一下
	yum install redis -y     #查看redis是从哪个yum源来的
		-y  一路默认的yes 
	6.只有通过yum安装的软件，才可以通过systemctl 管理 
		systemctl start/stop/restart/status  redis
